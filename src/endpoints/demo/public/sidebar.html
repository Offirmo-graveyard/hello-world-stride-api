<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><!-- http://stackoverflow.com/questions/14637943/what-is-x-ua-compatible-when-it-references-ie-edge-chrome-1 -->

	<title>Sidebar</title>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<style>
		body {
			font-family: 'Open Sans', 'Segoe UI', 'Open Sans', Helvetica, Arial, sans-serif;
			font-size: 14px;
		}
		input {
			color: teal;
			width: 100%;
		}
	</style>

	<!-- Import JQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<!-- Import the Stride Javascript API -->
	<script src='https://dev-lib.stride.com/javascript/simple-xdm.js'></script>


	<script>
		$(document).ready(function () {
			/**
			 * This is an example of how to call your app back-end from the front-end.
			 * You include a JWT token generated by Stride to:
			 * 1. Validate that the request is coming from your app
			 * 2. Send the context of the query (cloudId, conversationId) to the app back-end
			 */
			$("#test-button").click(function () {

				//console.log('AP', AP)

				AP.user.getCurrentUser(function(err, user) {
					if (err) return console.error(err)

					console.log({user})
					AP.auth.withToken(function (err, token) {
						if (err) return console.error(err)

						$.ajax({
							type: 'POST',
							url: '/demo/custom-request',
							headers: {'Authorization': 'Bearer ' + token},
							dataType: 'json',
							data: {
								requestId: 1,
								senderId: user.id,
							},
							success: console.log,
							error: console.error,
						});
					});
				})

				// append to message area, without sending
				AP.chat.appendMessage('test', function() {
					console.log('user', arguments)
				})
			});
		});
	</script>
</head>
<body>
Select an option

<ul>
	<li><button type="button" id="test-button">Test</button></li>
</ul>
</body>
